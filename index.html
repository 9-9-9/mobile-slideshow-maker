<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="icongrid/icongrid.css">
<style>
#grid {
  width: 300px;
  height: 300px;
  border: 1px solid black;
}
</style>
<title>Hello</title>
<div id="grid"></div>
<form>
  <input type="file" id="input-file">
  <button type="submit" style="display: none">Add Picture</button>
</form>
<script src="vendor/IndexedDBShim.min.js"></script>
<script src="vendor/jquery.min.js"></script>
<script src="icongrid/base32.js"></script>
<script src="icongrid/icongrid.js"></script>
<script src="data-uri-store.js"></script>
<script>
$("#input-file").change(function() {
  $("form").submit();
});

$("form").submit(function() {
  resizeAndUploadImage($("#input-file")[0].files[0]);
  return false;
});

function resizeAndUploadImage(file) {
  var reader = new FileReader();
  reader.onload = function(event) {
    var dataURI = event.target.result;
    console.log("data is " + dataURI.length + " characters");
  };
  console.log("starting to read...");
  reader.readAsDataURL(file);
}

$(window).ready(function() {
  var dataSource = {
    getItemList: function(callback) {
      callback({
        apple: {
          itemTitle: "Apple",
          itemImgURL: "http://mozilla.github.com/icongrid/images/apple.png"
        }
      });
    },
    openItem: function(itemID) {
      
    },
    userRemovedItem: function(itemID, callback) {
      
    }
  };
  var gridDiv = $("#grid");
  var layout = new GridLayout(gridDiv.width(), gridDiv.height(), 3, 3);
  var grid = new IconGrid("grid", gridDiv, dataSource, layout);
  
  grid.initialize();
  grid.refresh();
});
</script>
